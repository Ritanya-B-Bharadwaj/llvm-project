{
    "number": 142742,
    "title": "[OpenMP][cmake] Simplify -m32 handling",
    "body": "Linking `libomp.so` on 32-bit SPARC `FAIL`s with\r\n```\r\nld: fatal: file projects/openmp/runtime/src/CMakeFiles/omp.dir/z_Linux_asm.S.o: wrong ELF class: ELFCLASS64\r\n```\r\nThis was a 1-stage build with a 64-bit-default `gcc`.  Unlike the C++ sources, which were compiled as 32-bit objects due to the use of `-DCMAKE_CXX_FLAGS=-m32`, the assembler sources were not.\r\n\r\nThis patch simplifies passing `-m32`: instead of doing it per architecture, `-m32` is now always passed when the target uses 32-bit pointers and supports the option.\r\n\r\nTested on `sparc-sun-solaris2.11`, `sparcv9-sun-solaris2.11`, `sparc-unknown-linux-gnu`, `sparc64-unknown-linux-gnu`, `i386-pc-solaris2.11`, `amd64-pc-solaris2.11`, `i686-pc-linux-gnu`, and `x86_64-pc-linux-gnu`.",
    "created_at": "2025-06-04T08:42:12Z",
    "merged_at": "2025-06-05T06:34:59Z",
    "user": "rorth",
    "files": [
        "openmp/runtime/cmake/LibompHandleFlags.cmake"
    ],
    "commits": [
        "[OpenMP][cmake] Simplify -m32 handling\n\nLinking `libomp.so` on 32-bit SPARC `FAIL`s with\n```\nld: fatal: file projects/openmp/runtime/src/CMakeFiles/omp.dir/z_Linux_asm.S.o: wrong ELF class: ELFCLASS64\n```\nThis was a 1-stage build with a 64-bit-default `gcc`.  Unlike the C++\nsources, which were compiled as 32-bit objects due to the use of\n`-DCMAKE_CXX_FLAGS=-m32`, the assembler sources were not.\n\nThis patch simplifies passing `-m32`: instead of doing it per architecture,\n`-m32` is now always passed when the target uses 32-bit pointers and\nsupports the option.\n\nTested on `sparc-sun-solaris2.11`, `sparcv9-sun-solaris2.11`,\n`sparc-unknown-linux-gnu`, `sparc64-unknown-linux-gnu`,\n`i386-pc-solaris2.11`, `amd64-pc-solaris2.11`, `i686-pc-linux-gnu`, and\n`x86_64-pc-linux-gnu`."
    ]
}